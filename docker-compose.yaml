# =============================================================================
# docker-compose: NestJS 앱 한 번에 빌드 & 실행 (프로덕션 모드)
# =============================================================================
# 사용법:
#   빌드 후 실행:  docker compose up --build
#   백그라운드:    docker compose up -d --build
#   중지:         docker compose down
#
# 개발 모드:  docker compose -f docker-compose.dev.yaml up --build  (dockerfile.dev 사용)
# =============================================================================

services:
  app:
    build:
      context: .
      dockerfile: dockerfile
    image: first-nestjs-app
    container_name: first-nestjs-app
    ports:
      - '8080:8080'
    environment:
      NODE_ENV: production
      PORT: '8080'
    # 루트에 .env 가 있으면 아래 주석 해제 시 해당 변수들이 컨테이너에 주입됨
    env_file:
      - .env
    restart: unless-stopped
